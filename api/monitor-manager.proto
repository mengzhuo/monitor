syntax = "proto3";

option go_package = "./pb";

package api;

import "timestamp.proto";
import "duration.proto";
// import "ip.proto";

service Monitor {
  rpc GetConfig(GetConfigParams) returns (Config) {}

  // GetServers fetches list of NTP servers to check
  rpc GetServers(GetServersParams) returns (ServerList) {}

  // SubmitResults returns the specified list ServerStatus to the monitoring server
  rpc SubmitResults(ServerStatusList) returns (ServerStatusResult) {}
}

message GetConfigParams {}
message GetServersParams {}

// Config is the server set configuration for the monitoring agent
message Config {
  int32  Samples = 1;
  bytes  IPBytes = 2;
}

message ServerList {
  Config config  = 1;
  repeated bytes IPBytes = 2;
}

message ServerStatusList {
  repeated ServerStatus List = 1;
}

message ServerStatusResult {
  bool Ok = 1;
}

message ServerStatus {
  google.protobuf.Timestamp  TS = 1;
  bytes IPBytes = 2;
  google.protobuf.Duration Offset = 3;
  google.protobuf.Duration RTT = 4;
  int32 Stratum = 5;
  sint32 Leap = 6;
  string Error = 7;
  bool  NoResponse = 8;
}
